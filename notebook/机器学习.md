# 机器学习笔记

[toc]

## 机器学习分类

**根据输入数据来选择最合适的机器学习方法才能获得最好的效果。**

### 1. 监督学习（分类，回归）

训练数据有明确的**输入/输出对**，输入为**特征**，输出为**标签**。

根据训练过程中的输出结果与真是结果（标签）的差值，称为**误差**，来不断调整模型参数，直到达到预期的**准确率**。

此时训练结束，得到一个预测模型，可以对新数据进行预测。

eg：垃圾邮件处理，人脸识别，温度预测等分类和回归问题，

常见算法为逻辑回归，神经网络，支持向量机，决策树等。

### 2. 无监督学习（关联规则，聚类，降维）

数据只有输入特征，没有输出标签，学习模型为了推断出数据的一些内在结构。

eg：客户兴趣，新闻主题，舆情分析等，

常见算法为关联规则（Apriori算法），聚类（K-Means算法），降维（PCA算法）等。

### 3. 半监督学习

部分数据被标识，部分没有标识，此种学习方法可以用来预测，但是模型首先学习数据的内在结构以便合理的组织数据来进行预测。

算法包括对常用监督式学习算法的延伸，首先是试图对未标记数据进行预测，

eg：图论推理算法（Graph Inference）和拉普拉斯支持向量机（Laplacian SVM）等。

### 4. 强化学习

模型根据环境反馈，模型立即做出调整。

应用如：扫地机器人，人机对战，动态系统，机器人控制

常见算法有Q-Learning和时间差学习

## 算法分类

### 1. 回归算法

### 2. 基于实例的算法

### 3. 正则化算法

### 4. 基于树的算法

### 5. 贝叶斯方法

### 6. 基于核的算法

### 7. 聚类算法

### 8. 关联规则算法

### 9.人工神经网络

### 10. 深度学习

### 11. 降维算法

### 12. 集成方法

$$
\frac{\partial x}{\partial y}
$$

标准bp，积累bp

试错法

过度拟合：

训练集与验证集来防止，

正则法，交叉验证法

跳出局部极小：

不同参数值初始化

在迭代过程中，接受次优解，并随时间推移降低“模拟退火”

随机梯度下降

深度学习：

标准bp算法使得误差发散

无监督逐层训练 预训练+微调

权共享 CNN

### 卷积神经网络

##### **感受野：**

指特征图上的某个点能看到的输入图像的区域，即特征图上的点是由输入图像中感受野大小区域的计算得到的

![img](https://pic4.zhimg.com/80/v2-01b5d29d1ad4f39e9ad8d1908284d61b_720w.webp)

神经元感受野的值越大表示其能接触到的原始图像范围就越大，也意味着它可能蕴含更为全局，语义层次更高的特征；相反，值越小则表

示其所包含的特征越趋向局部和细节。因此**感受野的值可以用来大致判断每一层的抽象层次**。

卷积层与池化层都会影响感受野，激活函数层与当前层步长不影响当前层感受野，与填补也没有关系。

计算公式如下：
$$
RF_{i+1}=RF_i+(k-1)✖S_i
$$
其中$$RF_{i+1}$$表示当前层的感受野，$$RF_i$$表示上一层的感受野，$$k$$表示卷积核大小，例如3*3的卷积核，则k=3,$$S_i$$表示之前所有层的步长的

乘积（不包括本层），公式如下：
$$
S_i=\prod^i_{i=1}Stride_i
$$
补充：通常上述公式求取的感受野通常很大,而实际的**有效感受野(Effective Receptive Field)**往往小于理论感受野,因为输入层中边缘点

的使用次数明显比中间点要少,因此作出的贡献不同,所以经过多层的卷积堆叠后,输入层对于特征图点做出的贡献分布呈正态分布形状。

##### Matplotlib

##### 在python中读取图片，并转化为numpy.ndarray（）格式

图片的存储路径为：

**dirpath = "C:/Users/wuzhengxiang/Desktop/beatgirl.jpg"**

在此仅展示两种基于matplotlib的读取方法

利用matplotlib.image读取的图片，直接就生成了数组格式

```python
import matplotlib.image as mpig
img_mpig = mpig.imread(dirpath)#读取数据

print("img_mpig :",img_mpig .shape)
img_mpig : (1856, 2736, 3)

print("img_mpig :",type(img_mpig ))
img_mpig : <class 'numpy.ndarray'
```

利用matplotlib.pyplot读取的图片，同样也是直接就生成了数组格式

```python
import matplotlib.pyplot as plt
img_plt = plt.imread(dirpath#填写文件地址，注意 \  / 的区别，或者在开头加入r“xxxx”)

print("img_plt :",img_plt .shape)
img5: (1856, 2736, 3)

print("img_plt :",type(img_plt ))
img5: <class 'numpy.ndarray'>
```

展示图片同样使用matplotlib

```python
plt.imshow(img_plt , cmap=plt.cm.binary)
plt.show()
```

对于图片三通道，也可以打印其中一个

```python
plt.imshow(img_plt[:,:,1] , cmap=plt.cm.binary)
plt.show()
```

##### Numpy

这是一个数学库函数，主要用于数组计算，运行速度非常快，包括：

- 一个强大的N维数组对象 ndarray
- 广播功能函数
- 整合 C/C++/Fortran 代码的工具
- 线性代数、傅里叶变换、随机数生成等功能

numpy常与matplotlib和scipy协同使用，组合广泛用于替代Matlab，强大的科学计算环境，有助于我们通过 Python 学习数据科学或者

机器学习。

神经网络中，主要通过图片转化为ndarray的数组格式，进行读取数据。

进行矩阵运算，大幅缩减计算成本，节省算力。

##### 反向传播

池化层：最大池化时，仅最大数字对结果有影响，所以该数字对应误差权重为1，其他数字都是0

​				平均池化的误差是		delta误差除以区域大小

卷积层：对应于前向传播的权重，相关的加和因子的delta误差乘以权重，再加和为该点的delta误差

分析发现：**原图的delta误差，等于卷积结果的delta误差经过零填充后，与卷积核旋转180度后的卷积。**![](https://pic2.zhimg.com/80/v2-ad514ca02ba824ae81df10f98a003159_720w.webp)

反向传播采用的方法常为梯度下降法

##### 卷积的三种模式：full，same,valid

1.full mode

![img](https://img-blog.csdn.net/20180515205400757)

2.same mode

![img](https://img-blog.csdn.net/20180515205624201)

3.valid

![img](https://img-blog.csdn.net/20180515205946981)

##### 激活函数

激活函数可以对数据进行非线性运算处理，使得误差调整具有多样性，可以表达复杂的数据分布，解

决线性模型不能解决的问题。

常用函数有：Sigmoid，ReLU函数等

##### Softmax函数

本质是将向量中元素取值介于（0，1）之间，是对逻辑回归的推广，用来处理多分类问题。因此常被

用作输出层的激活函数。

##### 遇到的错误

1.输入图片文件打开过多，需要及时关闭image.close（）

2.类函数后无参数要加（）,eg:Conv.forward==()==

3.numpy列表元素相乘（dot），需要用二维列表，reshape（1，-1）可以通用转化;

flatten则需慎重考虑

4.对于二维列表尤其是经过reshape（1，-1）过的，用np.size获取元素总数，len（）只能获取一行或者一列

5.很多矩阵的维数问题，相乘相加，（1，m）要写成二维，np.zeros((1,m))

